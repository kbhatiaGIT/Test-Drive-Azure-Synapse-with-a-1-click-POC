{
	"name": "Dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Excel1",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Parquet1",
						"type": "DatasetReference"
					},
					"name": "sink1"
				},
				{
					"dataset": {
						"referenceName": "AzureSynapseAnalyticsTable2",
						"type": "DatasetReference"
					},
					"name": "sink2"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				},
				{
					"name": "aggregate1",
					"description": "Aggregating data by 'pcode_short' producing columns 'total_count'"
				}
			],
			"scriptLines": [
				"source(output(",
				"          RECTYPE as boolean,",
				"          ALPHAIND as integer,",
				"          LEA as short,",
				"          ESTAB as short,",
				"          URN as integer,",
				"          SCHNAME as string,",
				"          ADDRESS1 as string,",
				"          ADDRESS2 as string,",
				"          ADDRESS3 as string,",
				"          TOWN as string,",
				"          PCODE as string,",
				"          TELNUM as integer,",
				"          PCON_CODE as string,",
				"          PCON_NAME as string,",
				"          URN_AC as integer,",
				"          SCHNAME_AC as string,",
				"          OPEN_AC as date,",
				"          NFTYPE as string,",
				"          ICLOSE as boolean,",
				"          RELDENOM as string,",
				"          AGERANGE as date,",
				"          CONFEXAM as string,",
				"          TAB15 as boolean,",
				"          TAB1618 as boolean,",
				"          TOTPUPS as string,",
				"          TPUPYEAR as short,",
				"          TELIG as short,",
				"          BELIG as string,",
				"          GELIG as string,",
				"          PBELIG as string,",
				"          PGELIG as string,",
				"          TKS1AVERAGE as string,",
				"          TKS1GROUP_L as string,",
				"          PTKS1GROUP_L as string,",
				"          TKS1GROUP_M as string,",
				"          PTKS1GROUP_M as string,",
				"          TKS1GROUP_H as string,",
				"          PTKS1GROUP_H as string,",
				"          TKS1GROUP_NA as string,",
				"          PTKS1GROUP_NA as string,",
				"          TFSM6CLA1A as string,",
				"          PTFSM6CLA1A as string,",
				"          TNotFSM6CLA1A as string,",
				"          PTNotFSM6CLA1A as string,",
				"          TEALGRP2 as string,",
				"          PTEALGRP2 as string,",
				"          TMOBN as string,",
				"          PTMOBN as string,",
				"          PTRWM_EXP as string,",
				"          PTRWM_HIGH as string,",
				"          READPROG as string,",
				"          READPROG_LOWER as string,",
				"          READPROG_UPPER as string,",
				"          READCOV as string,",
				"          WRITPROG as string,",
				"          WRITPROG_LOWER as string,",
				"          WRITPROG_UPPER as string,",
				"          WRITCOV as string,",
				"          MATPROG as string,",
				"          MATPROG_LOWER as string,",
				"          MATPROG_UPPER as string,",
				"          MATCOV as string,",
				"          PTREAD_EXP as string,",
				"          PTREAD_HIGH as string,",
				"          PTREAD_AT as string,",
				"          READ_AVERAGE as string,",
				"          PTGPS_EXP as string,",
				"          PTGPS_HIGH as string,",
				"          PTGPS_AT as string,",
				"          GPS_AVERAGE as string,",
				"          PTMAT_EXP as string,",
				"          PTMAT_HIGH as string,",
				"          PTMAT_AT as string,",
				"          MAT_AVERAGE as string,",
				"          PTWRITTA_EXP as string,",
				"          PTWRITTA_HIGH as string,",
				"          PTWRITTA_WTS as string,",
				"          PTWRITTA_AD as string,",
				"          PTSCITA_EXP as string,",
				"          PTSCITA_AD as string,",
				"          PTRWM_EXP_B as string,",
				"          PTRWM_EXP_G as string,",
				"          PTRWM_EXP_L as string,",
				"          PTRWM_EXP_M as string,",
				"          PTRWM_EXP_H as string,",
				"          PTRWM_EXP_FSM6CLA1A as string,",
				"          PTRWM_EXP_NotFSM6CLA1A as string,",
				"          DIFFN_RWM_EXP as string,",
				"          PTRWM_EXP_EAL as string,",
				"          PTRWM_EXP_MOBN as string,",
				"          PTRWM_HIGH_B as string,",
				"          PTRWM_HIGH_G as string,",
				"          PTRWM_HIGH_L as string,",
				"          PTRWM_HIGH_M as string,",
				"          PTRWM_HIGH_H as string,",
				"          PTRWM_HIGH_FSM6CLA1A as string,",
				"          PTRWM_HIGH_NotFSM6CLA1A as string,",
				"          DIFFN_RWM_HIGH as string,",
				"          PTRWM_HIGH_EAL as string,",
				"          PTRWM_HIGH_MOBN as string,",
				"          READPROG_B as string,",
				"          READPROG_B_LOWER as string,",
				"          READPROG_B_UPPER as string,",
				"          READPROG_G as string,",
				"          READPROG_G_LOWER as string,",
				"          READPROG_G_UPPER as string,",
				"          READPROG_L as string,",
				"          READPROG_L_LOWER as string,",
				"          READPROG_L_UPPER as string,",
				"          READPROG_M as string,",
				"          READPROG_M_LOWER as string,",
				"          READPROG_M_UPPER as string,",
				"          READPROG_H as string,",
				"          READPROG_H_LOWER as string,",
				"          READPROG_H_UPPER as string,",
				"          READPROG_FSM6CLA1A as string,",
				"          READPROG_FSM6CLA1A_LOWER as string,",
				"          READPROG_FSM6CLA1A_UPPER as string,",
				"          READPROG_NotFSM6CLA1A as string,",
				"          READPROG_NotFSM6CLA1A_LOWER as string,",
				"          READPROG_NotFSM6CLA1A_UPPER as string,",
				"          DIFFN_READPROG as string,",
				"          READPROG_EAL as string,",
				"          READPROG_EAL_LOWER as string,",
				"          READPROG_EAL_UPPER as string,",
				"          READPROG_MOBN as string,",
				"          READPROG_MOBN_LOWER as string,",
				"          READPROG_MOBN_UPPER as string,",
				"          WRITPROG_B as string,",
				"          WRITPROG_B_LOWER as string,",
				"          WRITPROG_B_UPPER as string,",
				"          WRITPROG_G as string,",
				"          WRITPROG_G_LOWER as string,",
				"          WRITPROG_G_UPPER as string,",
				"          WRITPROG_L as string,",
				"          WRITPROG_L_LOWER as string,",
				"          WRITPROG_L_UPPER as string,",
				"          WRITPROG_M as string,",
				"          WRITPROG_M_LOWER as string,",
				"          WRITPROG_M_UPPER as string,",
				"          WRITPROG_H as string,",
				"          WRITPROG_H_LOWER as string,",
				"          WRITPROG_H_UPPER as string,",
				"          WRITPROG_FSM6CLA1A as string,",
				"          WRITPROG_FSM6CLA1A_LOWER as string,",
				"          WRITPROG_FSM6CLA1A_UPPER as string,",
				"          WRITPROG_NotFSM6CLA1A as string,",
				"          WRITPROG_NotFSM6CLA1A_LOWER as string,",
				"          WRITPROG_NotFSM6CLA1A_UPPER as string,",
				"          DIFFN_WRITPROG as string,",
				"          WRITPROG_EAL as string,",
				"          WRITPROG_EAL_LOWER as string,",
				"          WRITPROG_EAL_UPPER as string,",
				"          WRITPROG_MOBN as string,",
				"          WRITPROG_MOBN_LOWER as string,",
				"          WRITPROG_MOBN_UPPER as string,",
				"          MATPROG_B as string,",
				"          MATPROG_B_LOWER as string,",
				"          MATPROG_B_UPPER as string,",
				"          MATPROG_G as string,",
				"          MATPROG_G_LOWER as string,",
				"          MATPROG_G_UPPER as string,",
				"          MATPROG_L as string,",
				"          MATPROG_L_LOWER as string,",
				"          MATPROG_L_UPPER as string,",
				"          MATPROG_M as string,",
				"          MATPROG_M_LOWER as string,",
				"          MATPROG_M_UPPER as string,",
				"          MATPROG_H as string,",
				"          MATPROG_H_LOWER as string,",
				"          MATPROG_H_UPPER as string,",
				"          MATPROG_FSM6CLA1A as string,",
				"          MATPROG_FSM6CLA1A_LOWER as string,",
				"          MATPROG_FSM6CLA1A_UPPER as string,",
				"          MATPROG_NotFSM6CLA1A as string,",
				"          MATPROG_NotFSM6CLA1A_LOWER as string,",
				"          MATPROG_NotFSM6CLA1A_UPPER as string,",
				"          DIFFN_MATPROG as string,",
				"          MATPROG_EAL as string,",
				"          MATPROG_EAL_LOWER as string,",
				"          MATPROG_EAL_UPPER as string,",
				"          MATPROG_MOBN as string,",
				"          MATPROG_MOBN_LOWER as string,",
				"          MATPROG_MOBN_UPPER as string,",
				"          READ_AVERAGE_B as string,",
				"          READ_AVERAGE_G as string,",
				"          READ_AVERAGE_L as string,",
				"          READ_AVERAGE_M as string,",
				"          READ_AVERAGE_H as string,",
				"          READ_AVERAGE_FSM6CLA1A as string,",
				"          READ_AVERAGE_NotFSM6CLA1A as string,",
				"          READ_AVERAGE_EAL as string,",
				"          READ_AVERAGE_MOBN as string,",
				"          MAT_AVERAGE_B as string,",
				"          MAT_AVERAGE_G as string,",
				"          MAT_AVERAGE_L as string,",
				"          MAT_AVERAGE_M as string,",
				"          MAT_AVERAGE_H as string,",
				"          MAT_AVERAGE_FSM6CLA1A as string,",
				"          MAT_AVERAGE_NotFSM6CLA1A as string,",
				"          MAT_AVERAGE_EAL as string,",
				"          MAT_AVERAGE_MOBN as string,",
				"          GPS_AVERAGE_B as string,",
				"          GPS_AVERAGE_G as string,",
				"          GPS_AVERAGE_L as string,",
				"          GPS_AVERAGE_M as string,",
				"          GPS_AVERAGE_H as string,",
				"          GPS_AVERAGE_FSM6CLA1A as string,",
				"          GPS_AVERAGE_NotFSM6CLA1A as string,",
				"          GPS_AVERAGE_EAL as string,",
				"          GPS_AVERAGE_MOBN as string,",
				"          PTREAD_EXP_L as string,",
				"          PTREAD_EXP_M as string,",
				"          PTREAD_EXP_H as string,",
				"          PTREAD_EXP_FSM6CLA1A as string,",
				"          PTREAD_EXP_NotFSM6CLA1A as string,",
				"          PTGPS_EXP_L as string,",
				"          PTGPS_EXP_M as string,",
				"          PTGPS_EXP_H as string,",
				"          PTGPS_EXP_FSM6CLA1A as string,",
				"          PTGPS_EXP_NotFSM6CLA1A as string,",
				"          PTMAT_EXP_L as string,",
				"          PTMAT_EXP_M as string,",
				"          PTMAT_EXP_H as string,",
				"          PTMAT_EXP_FSM6CLA1A as string,",
				"          PTMAT_EXP_NotFSM6CLA1A as string,",
				"          PTWRITTA_EXP_L as string,",
				"          PTWRITTA_EXP_M as string,",
				"          PTWRITTA_EXP_H as string,",
				"          PTWRITTA_EXP_FSM6CLA1A as string,",
				"          PTWRITTA_EXP_NotFSM6CLA1A as string,",
				"          PTREAD_HIGH_L as string,",
				"          PTREAD_HIGH_M as string,",
				"          PTREAD_HIGH_H as string,",
				"          PTREAD_HIGH_FSM6CLA1A as string,",
				"          PTREAD_HIGH_NotFSM6CLA1A as string,",
				"          PTGPS_HIGH_L as string,",
				"          PTGPS_HIGH_M as string,",
				"          PTGPS_HIGH_H as string,",
				"          PTGPS_HIGH_FSM6CLA1A as string,",
				"          PTGPS_HIGH_NotFSM6CLA1A as string,",
				"          PTMAT_HIGH_L as string,",
				"          PTMAT_HIGH_M as string,",
				"          PTMAT_HIGH_H as string,",
				"          PTMAT_HIGH_FSM6CLA1A as string,",
				"          PTMAT_HIGH_NotFSM6CLA1A as string,",
				"          PTWRITTA_HIGH_L as string,",
				"          PTWRITTA_HIGH_M as string,",
				"          PTWRITTA_HIGH_H as string,",
				"          PTWRITTA_HIGH_FSM6CLA1A as string,",
				"          PTWRITTA_HIGH_NotFSM6CLA1A as string,",
				"          TEALGRP1 as string,",
				"          PTEALGRP1 as string,",
				"          TEALGRP3 as string,",
				"          PTEALGRP3 as string,",
				"          TSENELE as string,",
				"          PSENELE as string,",
				"          TSENELK as string,",
				"          PSENELK as string,",
				"          TSENELEK as string,",
				"          PSENELEK as string,",
				"          TELIG_18 as short,",
				"          PTFSM6CLA1A_18 as string,",
				"          PTNOTFSM6CLA1A_18 as string,",
				"          PTRWM_EXP_18 as string,",
				"          PTRWM_HIGH_18 as string,",
				"          PTRWM_EXP_FSM6CLA1A_18 as string,",
				"          PTRWM_HIGH_FSM6CLA1A_18 as string,",
				"          PTRWM_EXP_NotFSM6CLA1A_18 as string,",
				"          PTRWM_HIGH_NotFSM6CLA1A_18 as string,",
				"          READPROG_18 as string,",
				"          READPROG_LOWER_18 as string,",
				"          READPROG_UPPER_18 as string,",
				"          WRITPROG_18 as string,",
				"          WRITPROG_LOWER_18 as string,",
				"          WRITPROG_UPPER_18 as string,",
				"          MATPROG_18 as string,",
				"          MATPROG_LOWER_18 as string,",
				"          MATPROG_UPPER_18 as string,",
				"          READ_AVERAGE_18 as string,",
				"          MAT_AVERAGE_18 as string,",
				"          TELIG_17 as short,",
				"          PTFSM6CLA1A_17 as string,",
				"          PTNOTFSM6CLA1A_17 as string,",
				"          PTRWM_EXP_17 as string,",
				"          PTRWM_HIGH_17 as string,",
				"          PTRWM_EXP_FSM6CLA1A_17 as string,",
				"          PTRWM_HIGH_FSM6CLA1A_17 as string,",
				"          PTRWM_EXP_NotFSM6CLA1A_17 as string,",
				"          PTRWM_HIGH_NotFSM6CLA1A_17 as string,",
				"          READPROG_17 as string,",
				"          READPROG_LOWER_17 as string,",
				"          READPROG_UPPER_17 as string,",
				"          WRITPROG_17 as string,",
				"          WRITPROG_LOWER_17 as string,",
				"          WRITPROG_UPPER_17 as string,",
				"          MATPROG_17 as string,",
				"          MATPROG_LOWER_17 as string,",
				"          MATPROG_UPPER_17 as string,",
				"          READ_AVERAGE_17 as string,",
				"          MAT_AVERAGE_17 as string,",
				"          TELIG_3YR as short,",
				"          PTRWM_EXP_3YR as string,",
				"          PTRWM_HIGH_3YR as string,",
				"          READ_AVERAGE_3YR as string,",
				"          MAT_AVERAGE_3YR as string,",
				"          READPROG_UNADJUSTED as string,",
				"          WRITPROG_UNADJUSTED as string,",
				"          MATPROG_UNADJUSTED as string,",
				"          READPROG_DESCR_17 as string,",
				"          WRITPROG_DESCR_17 as string,",
				"          MATPROG_DESCR_17 as string,",
				"          READPROG_DESCR_18 as string,",
				"          WRITPROG_DESCR_18 as string,",
				"          MATPROG_DESCR_18 as string,",
				"          READPROG_DESCR as string,",
				"          WRITPROG_DESCR as string,",
				"          MATPROG_DESCR as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 derive(pcode_short = substring(PCODE,0,4)) ~> derivedColumn1",
				"derivedColumn1 aggregate(groupBy(pcode_short),",
				"     total_count = count()) ~> aggregate1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'parquet',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1",
				"aggregate1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     staged: true,",
				"     allowCopyCommand: true,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink2"
			]
		}
	}
}